"use strict";exports.id=441,exports.ids=[441],exports.modules={9249:(e,r,t)=>{t.d(r,{M:()=>w});var a=t(28625),l=t(25226),s=t(61379),n=t(51287),o=t(22919),i=t(64996),d=t(79155),c=t(43269);function m({title:e,value:r,fields:t,onChange:l,errors:s={},className:n=""}){let{t:o}=(0,d.Bd)();return(0,a.jsxs)("section",{className:`p-4 flex flex-col lg:flex-row text-graphite font-light ${n}`,children:[e&&(0,a.jsx)("div",{className:"w-full lg:w-[30%] p-3 bg-gray-50 border border-gray-200 rounded-md mb-4 lg:mb-0 lg:mr-4",children:(0,a.jsx)("h1",{className:"text-lg font-semibold break-words",children:e})}),(0,a.jsx)("div",{className:`${e?"w-full lg:w-[70%]":"w-full"} flex flex-col p-2 space-y-3`,children:t.map(e=>{let t=s?.[e.key],n=t&&""!==t;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:e.key,className:"block mb-1 font-semibold",children:[e.label," ",e.required&&(0,a.jsx)("span",{className:"text-red-600",children:"*"})]}),e.isTextarea?(0,a.jsx)("textarea",{id:e.key,value:r[e.key]??"",onChange:r=>l(e.key,r.target.value),className:`w-full p-2 border rounded-md focus:outline-none focus:ring-2 ${n?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:e.placeholder?o(e.placeholder):void 0,rows:3,required:e.required,"aria-invalid":n,"aria-describedby":n?`${e.key}-error`:void 0}):(0,a.jsx)("input",{id:e.key,type:e.type||"text",value:r[e.key]??"",onChange:r=>l(e.key,r.target.value),className:`w-full p-2 border rounded-md focus:outline-none focus:ring-2 ${n?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,placeholder:e.placeholder?o(e.placeholder):void 0,required:e.required,"aria-invalid":n,"aria-describedby":n?`${e.key}-error`:void 0}),n&&(0,a.jsx)("p",{id:`${e.key}-error`,className:"mt-1 text-sm text-red-600",role:"alert",children:t})]},e.key)})})]})}var p=t(54055),u=t(22349),h=t(78361);let v=({initialValues:e,defaultValues:r=(0,p.getDefaultPersonForm)(),itemId:t,onClose:a,onSuccess:l})=>{let s=(0,u.A)({itemName:"Person",initialValues:e,defaultValues:r,itemId:t,onClose:a,onSuccess:l,createRecord:h.DF.create,updateRecord:h.DF.update,getCreateDto:e=>({type:o.ClientType.PERSON,data:(0,p.convertPersonFormToDto)(e)}),getUpdateDto:e=>({type:o.ClientType.PERSON,data:(0,p.convertPersonFormToDto)(e)}),validator:p.validatePersonForm});return{form:s,handlers:{updateField:(e,r)=>s.setValues(e,r)}}},x=({open:e,person:r,clientId:t,variant:l,onSuccess:o,onClose:u})=>{let{t:h}=(0,d.Bd)(),{form:x,handlers:y}=v({initialValues:r??void 0,defaultValues:(0,p.getDefaultPersonForm)(),itemId:t,onClose:u,onSuccess:o}),f=(0,i.useCallback)((e,r)=>{y.updateField(e,r)},[y]),g=!!r||void 0!==t,b=x.canSubmit&&(!g||g&&void 0!==t&&t>0),j=(0,a.jsx)("div",{className:"h-full flex flex-col",children:(0,a.jsx)(m,{value:x.values,onChange:f,fields:[{key:"fullName",label:h("entities.person.fullName"),required:!0,placeholder:h("common.placeholders.name")},{key:"phone",label:h("common.fields.phone"),type:"tel",placeholder:h("common.placeholders.phone")},{key:"email",label:h("common.fields.email"),type:"email",placeholder:h("common.placeholders.email")},{key:"address",label:h("common.fields.address"),type:"textarea",placeholder:h("common.placeholders.address")}],errors:x.validationErrors})}),N=g?c.uO9:s.Y9o,C=g?c.uO9:c.OiG;return(0,a.jsx)(n.I,{open:e,canSubmit:b,variant:l,title:h(g?"entities.person.edit":"entities.person.create"),titleIcon:(0,a.jsx)(N,{size:22}),primaryActionLabel:h(g?"forms.base.saveChanges":"entities.person.create"),primaryActionIcon:(0,a.jsx)(C,{}),onSubmit:x.submit,onClose:u,onReset:x.reset,hasUnsavedChanges:x.isDirty,children:j})};var y=t(69465);let f=e=>({name:e?.name??"",taxId:e?.taxId??"",headquarters:e?.headquarters??"",email:e?.email??"",phone:e?.phone??"",representatives:[]}),g=(e,r)=>{if(!r)return{};if(!e)return{...r};let t=f({...r,...e});return"representatives"in e&&e.representatives?{...t,representatives:e.representatives.map(e=>({personId:e.personId||e.person?.id||0,fullName:e.person?.fullName||"",phone:e.person?.phone||"",email:e.person?.email||"",address:e.person?.address||""}))}:t},b=({initialValues:e,defaultValues:r=(0,p.getDefaultCompanyForm)(),itemId:t,onClose:a,onSuccess:l})=>{let s=(0,u.A)({itemName:"Company",initialValues:e,defaultValues:r,itemId:t,onClose:a,onSuccess:l,createRecord:h.DF.create,updateRecord:h.DF.update,getCreateDto:e=>({type:o.ClientType.COMPANY,data:(0,p.convertCompanyFormToDto)(e)}),getUpdateDto:e=>({type:o.ClientType.COMPANY,data:(0,p.convertCompanyFormToDto)(e)}),validator:p.validateCompanyForm,mergeWithDefaults:g});return{form:s,handlers:{updateField:(e,r)=>s.setValues(e,r),addRepresentative:e=>{s.setValues("representatives",[...s.values.representatives,e])},removeRepresentative:e=>{s.setValues("representatives",s.values.representatives.filter((r,t)=>t!==e))},updateRepresentative:(e,r,t)=>{s.setValues("representatives",s.values.representatives.map((a,l)=>l===e?{...a,[r]:t}:a))}}}},j=({open:e,company:r,clientId:t,variant:l,onSuccess:o,onClose:i})=>{let{t:u}=(0,d.Bd)(),{form:h,handlers:v}=b({initialValues:r??void 0,defaultValues:(0,p.getDefaultCompanyForm)(),itemId:t,onClose:i,onSuccess:o}),x=!!r||void 0!==t,f=h.canSubmit&&(!x||x&&void 0!==t&&t>0),g=(0,a.jsxs)("div",{className:"text-graphite font-light overflow-x-hidden h-full",children:[(0,a.jsx)(m,{value:h.values,onChange:(e,r)=>v.updateField(e,r),fields:[{key:"name",label:u("common.fields.name"),required:!0,placeholder:u("common.placeholders.name")},{key:"taxId",label:u("entities.company.taxId"),placeholder:u("common.placeholders.taxId")},{key:"phone",label:u("common.fields.phone"),type:"tel",placeholder:u("common.placeholders.phone")},{key:"email",label:u("common.fields.email"),type:"email",placeholder:u("common.placeholders.email")},{key:"headquarters",label:u("common.fields.headquarters"),type:"textarea",placeholder:u("common.placeholders.headquarters")}],errors:h.validationErrors}),(0,a.jsxs)("div",{className:`p-4 space-y-4 ${h.values.representatives.length>0?"bg-gray-200":""}`,children:[h.values.representatives.length>0&&(0,a.jsx)("div",{className:"space-y-4",children:h.values.representatives.map((e,r)=>(0,a.jsxs)("div",{className:"relative bg-white border border-gray-300 rounded-md shadow-sm p-4",children:[(0,a.jsx)(m,{title:e.fullName?`${u("common.entities.representative")}: ${e.fullName}`:`${u("common.entities.representative")} ${r+1}`,value:e,fields:[{key:"fullName",label:u("entities.person.fullName"),required:!0,placeholder:u("common.placeholders.name")},{key:"phone",label:u("common.fields.phone"),type:"tel",placeholder:u("common.placeholders.phone")},{key:"email",label:u("common.fields.email"),type:"email",placeholder:u("common.placeholders.email")},{key:"address",label:u("common.fields.address"),type:"textarea",placeholder:u("common.placeholders.address")}],errors:Array.isArray(h.validationErrors?.representatives)?h.validationErrors.representatives[r]:void 0,onChange:(e,t)=>v.updateRepresentative(r,e,t),className:"mt-7"}),(0,a.jsx)(y.J,{onClick:()=>v.removeRepresentative(r),title:u("common.actions.delete"),className:"absolute top-3 right-3"})]},r))}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)("button",{type:"button",onClick:()=>v.addRepresentative((0,p.getDefaultRepresentativeForm)()),className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium text-green-700 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 hover:border-green-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-150",children:[(0,a.jsx)("span",{className:"text-green-600 text-lg",children:"+"})," ",u("common.actions.add")," ",u("common.entities.representative").toLowerCase()]})})]})]}),j=x?c.uO9:s.Y9o,N=x?c.uO9:c.OiG;return(0,a.jsx)(n.I,{open:e,canSubmit:f,variant:l,title:x?u("entities.company.edit"):u("entities.company.create"),titleIcon:(0,a.jsx)(j,{size:22}),primaryActionLabel:x?u("common.actions.save"):u("entities.company.create"),primaryActionIcon:(0,a.jsx)(N,{}),onSubmit:h.submit,onClose:i,onReset:h.reset,hasUnsavedChanges:h.isDirty,children:g})},N=({value:e,options:r,onChange:t,label:l,className:s=""})=>(0,a.jsxs)("div",{className:`mb-4 ${s}`,children:[l&&(0,a.jsx)("label",{className:"font-semibold mb-2 block text-graphite",children:l}),(0,a.jsx)("div",{className:"flex font-light text-sm space-x-1",children:r.map(r=>(0,a.jsxs)("button",{type:"button",onClick:()=>t(r.value),style:{boxShadow:"inset 0 2px 4px rgba(0,0,0,0.1)"},className:`p-3 rounded-md transition-colors flex items-center justify-center gap-2 flex-1 border text-sm font-medium
    ${e===r.value?r.activeClass||"bg-blue-50 border-blue-200 text-blue-700":r.inactiveClass||"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"}`,children:[r.icon&&(0,a.jsx)("span",{className:"text-lg flex items-center justify-center",children:r.icon}),(0,a.jsx)("span",{children:r.label})]},String(r.value)))})]});var C=t(36317),k=t(40334);let w=({open:e,client:r,clientId:t,variant:c,onSuccess:m,onClose:p})=>{let{t:u}=(0,d.Bd)(),[h,v]=(0,i.useState)(o.ClientType.PERSON),y=!!t||!!r;(0,i.useEffect)(()=>{r&&("company"in r&&r.company?v(o.ClientType.COMPANY):v(o.ClientType.PERSON))},[r]);let f=[{value:o.ClientType.PERSON,label:u("entities.client.individual"),icon:(0,a.jsx)(C.yap,{})},{value:o.ClientType.COMPANY,label:u("entities.client.company"),icon:(0,a.jsx)(k.kUS,{})}];return(0,a.jsx)(n.I,{open:e,canSubmit:!1,variant:c,title:u(y?"entities.client.edit":"entities.client.create"),titleIcon:(0,a.jsx)(s.Y9o,{size:22}),onClose:p,onReset:()=>v(o.ClientType.PERSON),children:(0,a.jsxs)("div",{className:"flex flex-col flex-1 min-h-0",children:[(0,a.jsx)("div",{className:"flex-shrink-0 space-y-6",children:!y&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N,{value:h,options:f,onChange:v,className:"p-6 pb-0"}),(0,a.jsx)(l.A,{})]})}),(0,a.jsx)("div",{className:"flex-1 min-h-0",children:h===o.ClientType.PERSON?(0,a.jsx)(x,{open:e,person:r?.person,clientId:t,variant:"inline",onSuccess:m,onClose:p}):(0,a.jsx)(j,{open:e,company:r?.company,clientId:t,variant:"inline",onSuccess:m,onClose:p})})]})})}},69465:(e,r,t)=>{t.d(r,{J:()=>l});var a=t(28625);t(64996);let l=({onClick:e,title:r="",className:t="",iconSize:l=16})=>(0,a.jsx)("button",{onClick:r=>e?.(r),className:`
        p-1 flex items-center justify-center rounded-full
        border border-red-300 bg-white text-red-500
        hover:border-red-500 hover:bg-red-500 hover:text-white
        transition-all duration-200 focus:outline-none focus:ring-2
        focus:ring-red-500 focus:ring-offset-2 shadow-sm
        ${t}
      `,"aria-label":r,title:r,children:(0,a.jsx)("svg",{className:"text-current",width:l,height:l,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})},73625:(e,r,t)=>{t.d(r,{L:()=>s});var a=t(28625);t(64996);var l=t(66159);let s=({isExpanded:e,onToggle:r,count:t,label:s,className:n})=>{let o=null!=s||null!=t;return(0,a.jsxs)("button",{onClick:e=>{e.stopPropagation(),r(e)},"aria-expanded":e,className:`
        bg-gray-50 ring-1 ring-gray-300
        focus:outline-none focus:ring-2 focus:ring-gray-400
        text-gray-500 hover:text-gray-700
        flex items-center justify-center gap-1
        transition-colors duration-200
        ${o?"rounded-md px-3 py-1.5":"rounded w-6 h-6"}
        ${n}
      `,children:[o&&(0,a.jsx)("span",{className:"text-sm mr-2",children:s?`${s}${null!=t?` (${t})`:""}`:`${t}`}),(0,a.jsx)(l.A,{fontSize:"medium",className:"transition-transform duration-200",style:{transform:e?"rotate(180deg)":"rotate(0deg)"}})]})}}};