"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[207],{17503:(e,t,a)=>{a.d(t,{M:()=>w});var l=a(73365),r=a(59296),n=a(17463),o=a(36115),s=a(73104),i=a(1521),d=a(92222),c=a(87363);function m(e){let{title:t,value:a,fields:r,onChange:n,errors:o={},className:s=""}=e,{t:i}=(0,d.Bd)();return(0,l.jsxs)("section",{className:"p-4 flex flex-col lg:flex-row text-graphite font-light ".concat(s),children:[t&&(0,l.jsx)("div",{className:"w-full lg:w-[30%] p-3 bg-gray-50 border border-gray-200 rounded-md mb-4 lg:mb-0 lg:mr-4",children:(0,l.jsx)("h1",{className:"text-lg font-semibold break-words",children:t})}),(0,l.jsx)("div",{className:"".concat(t?"w-full lg:w-[70%]":"w-full"," flex flex-col p-2 space-y-3"),children:r.map(e=>{var t,r;let s=null==o?void 0:o[e.key],d=s&&""!==s;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:e.key,className:"block mb-1 font-semibold",children:[e.label," ",e.required&&(0,l.jsx)("span",{className:"text-red-600",children:"*"})]}),e.isTextarea?(0,l.jsx)("textarea",{id:e.key,value:null!==(t=a[e.key])&&void 0!==t?t:"",onChange:t=>n(e.key,t.target.value),className:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 ".concat(d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"),placeholder:e.placeholder?i(e.placeholder):void 0,rows:3,required:e.required,"aria-invalid":d,"aria-describedby":d?"".concat(e.key,"-error"):void 0}):(0,l.jsx)("input",{id:e.key,type:e.type||"text",value:null!==(r=a[e.key])&&void 0!==r?r:"",onChange:t=>n(e.key,t.target.value),className:"w-full p-2 border rounded-md focus:outline-none focus:ring-2 ".concat(d?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"),placeholder:e.placeholder?i(e.placeholder):void 0,required:e.required,"aria-invalid":d,"aria-describedby":d?"".concat(e.key,"-error"):void 0}),d&&(0,l.jsx)("p",{id:"".concat(e.key,"-error"),className:"mt-1 text-sm text-red-600",role:"alert",children:s})]},e.key)})})]})}var u=a(17349),p=a(35227),v=a(92890);let h=e=>{let{initialValues:t,defaultValues:a=(0,u.getDefaultPersonForm)(),itemId:l,onClose:r,onSuccess:n}=e,o=(0,p.A)({itemName:"Person",initialValues:t,defaultValues:a,itemId:l,onClose:r,onSuccess:n,createRecord:v.DF.create,updateRecord:v.DF.update,getCreateDto:e=>({type:s.ClientType.PERSON,data:(0,u.convertPersonFormToDto)(e)}),getUpdateDto:e=>({type:s.ClientType.PERSON,data:(0,u.convertPersonFormToDto)(e)}),validator:u.validatePersonForm});return{form:o,handlers:{updateField:(e,t)=>o.setValues(e,t)}}},x=e=>{let{open:t,person:a,clientId:r,variant:s,onSuccess:p,onClose:v}=e,{t:x}=(0,d.Bd)(),{form:f,handlers:y}=h({initialValues:null!=a?a:void 0,defaultValues:(0,u.getDefaultPersonForm)(),itemId:r,onClose:v,onSuccess:p}),g=(0,i.useCallback)((e,t)=>{y.updateField(e,t)},[y]),b=!!a||void 0!==r,j=f.canSubmit&&(!b||b&&void 0!==r&&r>0),N=(0,l.jsx)("div",{className:"h-full flex flex-col",children:(0,l.jsx)(m,{value:f.values,onChange:g,fields:[{key:"fullName",label:x("entities.person.fullName"),required:!0,placeholder:x("common.placeholders.name")},{key:"phone",label:x("common.fields.phone"),type:"tel",placeholder:x("common.placeholders.phone")},{key:"email",label:x("common.fields.email"),type:"email",placeholder:x("common.placeholders.email")},{key:"address",label:x("common.fields.address"),type:"textarea",placeholder:x("common.placeholders.address")}],errors:f.validationErrors})}),C=b?c.uO9:n.Y9o,k=b?c.uO9:c.OiG;return(0,l.jsx)(o.I,{open:t,canSubmit:j,variant:s,title:x(b?"entities.person.edit":"entities.person.create"),titleIcon:(0,l.jsx)(C,{size:22}),primaryActionLabel:x(b?"forms.base.saveChanges":"entities.person.create"),primaryActionIcon:(0,l.jsx)(k,{}),onSubmit:f.submit,onClose:v,onReset:f.reset,hasUnsavedChanges:f.isDirty,children:N})};var f=a(31643);let y=e=>{var t,a,l,r,n;return{name:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",taxId:null!==(a=null==e?void 0:e.taxId)&&void 0!==a?a:"",headquarters:null!==(l=null==e?void 0:e.headquarters)&&void 0!==l?l:"",email:null!==(r=null==e?void 0:e.email)&&void 0!==r?r:"",phone:null!==(n=null==e?void 0:e.phone)&&void 0!==n?n:"",representatives:[]}},g=(e,t)=>{if(!t)return{};if(!e)return{...t};let a=y({...t,...e});return"representatives"in e&&e.representatives?{...a,representatives:e.representatives.map(e=>{var t,a,l,r,n;return{personId:e.personId||(null===(t=e.person)||void 0===t?void 0:t.id)||0,fullName:(null===(a=e.person)||void 0===a?void 0:a.fullName)||"",phone:(null===(l=e.person)||void 0===l?void 0:l.phone)||"",email:(null===(r=e.person)||void 0===r?void 0:r.email)||"",address:(null===(n=e.person)||void 0===n?void 0:n.address)||""}})}:a},b=e=>{let{initialValues:t,defaultValues:a=(0,u.getDefaultCompanyForm)(),itemId:l,onClose:r,onSuccess:n}=e,o=(0,p.A)({itemName:"Company",initialValues:t,defaultValues:a,itemId:l,onClose:r,onSuccess:n,createRecord:v.DF.create,updateRecord:v.DF.update,getCreateDto:e=>({type:s.ClientType.COMPANY,data:(0,u.convertCompanyFormToDto)(e)}),getUpdateDto:e=>({type:s.ClientType.COMPANY,data:(0,u.convertCompanyFormToDto)(e)}),validator:u.validateCompanyForm,mergeWithDefaults:g});return{form:o,handlers:{updateField:(e,t)=>o.setValues(e,t),addRepresentative:e=>{o.setValues("representatives",[...o.values.representatives,e])},removeRepresentative:e=>{o.setValues("representatives",o.values.representatives.filter((t,a)=>a!==e))},updateRepresentative:(e,t,a)=>{o.setValues("representatives",o.values.representatives.map((l,r)=>r===e?{...l,[t]:a}:l))}}}},j=e=>{let{open:t,company:a,clientId:r,variant:s,onSuccess:i,onClose:p}=e,{t:v}=(0,d.Bd)(),{form:h,handlers:x}=b({initialValues:null!=a?a:void 0,defaultValues:(0,u.getDefaultCompanyForm)(),itemId:r,onClose:p,onSuccess:i}),y=!!a||void 0!==r,g=h.canSubmit&&(!y||y&&void 0!==r&&r>0),j=(0,l.jsxs)("div",{className:"text-graphite font-light overflow-x-hidden h-full",children:[(0,l.jsx)(m,{value:h.values,onChange:(e,t)=>x.updateField(e,t),fields:[{key:"name",label:v("common.fields.name"),required:!0,placeholder:v("common.placeholders.name")},{key:"taxId",label:v("entities.company.taxId"),placeholder:v("common.placeholders.taxId")},{key:"phone",label:v("common.fields.phone"),type:"tel",placeholder:v("common.placeholders.phone")},{key:"email",label:v("common.fields.email"),type:"email",placeholder:v("common.placeholders.email")},{key:"headquarters",label:v("common.fields.headquarters"),type:"textarea",placeholder:v("common.placeholders.headquarters")}],errors:h.validationErrors}),(0,l.jsxs)("div",{className:"p-4 space-y-4 ".concat(h.values.representatives.length>0?"bg-gray-200":""),children:[h.values.representatives.length>0&&(0,l.jsx)("div",{className:"space-y-4",children:h.values.representatives.map((e,t)=>{var a;return(0,l.jsxs)("div",{className:"relative bg-white border border-gray-300 rounded-md shadow-sm p-4",children:[(0,l.jsx)(m,{title:e.fullName?"".concat(v("common.entities.representative"),": ").concat(e.fullName):"".concat(v("common.entities.representative")," ").concat(t+1),value:e,fields:[{key:"fullName",label:v("entities.person.fullName"),required:!0,placeholder:v("common.placeholders.name")},{key:"phone",label:v("common.fields.phone"),type:"tel",placeholder:v("common.placeholders.phone")},{key:"email",label:v("common.fields.email"),type:"email",placeholder:v("common.placeholders.email")},{key:"address",label:v("common.fields.address"),type:"textarea",placeholder:v("common.placeholders.address")}],errors:Array.isArray(null===(a=h.validationErrors)||void 0===a?void 0:a.representatives)?h.validationErrors.representatives[t]:void 0,onChange:(e,a)=>x.updateRepresentative(t,e,a),className:"mt-7"}),(0,l.jsx)(f.J,{onClick:()=>x.removeRepresentative(t),title:v("common.actions.delete"),className:"absolute top-3 right-3"})]},t)})}),(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsxs)("button",{type:"button",onClick:()=>x.addRepresentative((0,u.getDefaultRepresentativeForm)()),className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium text-green-700 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 hover:border-green-300 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-150",children:[(0,l.jsx)("span",{className:"text-green-600 text-lg",children:"+"})," ",v("common.actions.add")," ",v("common.entities.representative").toLowerCase()]})})]})]}),N=y?c.uO9:n.Y9o,C=y?c.uO9:c.OiG;return(0,l.jsx)(o.I,{open:t,canSubmit:g,variant:s,title:y?v("entities.company.edit"):v("entities.company.create"),titleIcon:(0,l.jsx)(N,{size:22}),primaryActionLabel:y?v("common.actions.save"):v("entities.company.create"),primaryActionIcon:(0,l.jsx)(C,{}),onSubmit:h.submit,onClose:p,onReset:h.reset,hasUnsavedChanges:h.isDirty,children:j})},N=e=>{let{value:t,options:a,onChange:r,label:n,className:o=""}=e;return(0,l.jsxs)("div",{className:"mb-4 ".concat(o),children:[n&&(0,l.jsx)("label",{className:"font-semibold mb-2 block text-graphite",children:n}),(0,l.jsx)("div",{className:"flex font-light text-sm space-x-1",children:a.map(e=>(0,l.jsxs)("button",{type:"button",onClick:()=>r(e.value),style:{boxShadow:"inset 0 2px 4px rgba(0,0,0,0.1)"},className:"p-3 rounded-md transition-colors flex items-center justify-center gap-2 flex-1 border text-sm font-medium\n    ".concat(t===e.value?e.activeClass||"bg-blue-50 border-blue-200 text-blue-700":e.inactiveClass||"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"),children:[e.icon&&(0,l.jsx)("span",{className:"text-lg flex items-center justify-center",children:e.icon}),(0,l.jsx)("span",{children:e.label})]},String(e.value)))})]})};var C=a(70577),k=a(53032);let w=e=>{let{open:t,client:a,clientId:c,variant:m,onSuccess:u,onClose:p}=e,{t:v}=(0,d.Bd)(),[h,f]=(0,i.useState)(s.ClientType.PERSON),y=!!c||!!a;(0,i.useEffect)(()=>{a&&("company"in a&&a.company?f(s.ClientType.COMPANY):f(s.ClientType.PERSON))},[a]);let g=[{value:s.ClientType.PERSON,label:v("entities.client.individual"),icon:(0,l.jsx)(C.yap,{})},{value:s.ClientType.COMPANY,label:v("entities.client.company"),icon:(0,l.jsx)(k.kUS,{})}];return(0,l.jsx)(o.I,{open:t,canSubmit:!1,variant:m,title:v(y?"entities.client.edit":"entities.client.create"),titleIcon:(0,l.jsx)(n.Y9o,{size:22}),onClose:p,onReset:()=>f(s.ClientType.PERSON),children:(0,l.jsxs)("div",{className:"flex flex-col flex-1 min-h-0",children:[(0,l.jsx)("div",{className:"flex-shrink-0 space-y-6",children:!y&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(N,{value:h,options:g,onChange:f,className:"p-6 pb-0"}),(0,l.jsx)(r.A,{})]})}),(0,l.jsx)("div",{className:"flex-1 min-h-0",children:h===s.ClientType.PERSON?(0,l.jsx)(x,{open:t,person:null==a?void 0:a.person,clientId:c,variant:"inline",onSuccess:u,onClose:p}):(0,l.jsx)(j,{open:t,company:null==a?void 0:a.company,clientId:c,variant:"inline",onSuccess:u,onClose:p})})]})})}},31643:(e,t,a)=>{a.d(t,{J:()=>r});var l=a(73365);a(1521);let r=e=>{let{onClick:t,title:a="",className:r="",iconSize:n=16}=e;return(0,l.jsx)("button",{onClick:e=>null==t?void 0:t(e),className:"\n        p-1 flex items-center justify-center rounded-full\n        border border-red-300 bg-white text-red-500\n        hover:border-red-500 hover:bg-red-500 hover:text-white\n        transition-all duration-200 focus:outline-none focus:ring-2\n        focus:ring-red-500 focus:ring-offset-2 shadow-sm\n        ".concat(r,"\n      "),"aria-label":a,title:a,children:(0,l.jsx)("svg",{className:"text-current",width:n,height:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}},99849:(e,t,a)=>{a.d(t,{L:()=>n});var l=a(73365);a(1521);var r=a(68663);let n=e=>{let{isExpanded:t,onToggle:a,count:n,label:o,className:s}=e,i=null!=o||null!=n;return(0,l.jsxs)("button",{onClick:e=>{e.stopPropagation(),a(e)},"aria-expanded":t,className:"\n        bg-gray-50 ring-1 ring-gray-300\n        focus:outline-none focus:ring-2 focus:ring-gray-400\n        text-gray-500 hover:text-gray-700\n        flex items-center justify-center gap-1\n        transition-colors duration-200\n        ".concat(i?"rounded-md px-3 py-1.5":"rounded w-6 h-6","\n        ").concat(s,"\n      "),children:[i&&(0,l.jsx)("span",{className:"text-sm mr-2",children:o?"".concat(o).concat(null!=n?" (".concat(n,")"):""):"".concat(n)}),(0,l.jsx)(r.A,{fontSize:"medium",className:"transition-transform duration-200",style:{transform:t?"rotate(180deg)":"rotate(0deg)"}})]})}}}]);