(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22],{72631:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var o=n(73365),s=n(1521),l=n(32460),r=n(40870),a=n(35905),i=n(35935),d=n(87363),c=n(28402),m=n(52392),u=n(61831),p=n(3408),x=n(92222),g=n(92890),h=n(67616);let y=e=>{let{departments:t,refetch:n,withActions:l}=e,{t:a}=(0,x.Bd)(),[y,b]=(0,s.useState)({}),[v,j]=(0,s.useState)(null),[f,C]=(0,s.useState)([]),w=g.iw.useDelete({},{onSuccess:()=>null==n?void 0:n()}),N=g.iw.useDeleteMany({},{onSuccess:()=>null==n?void 0:n()}),A=e=>{b(t=>({...t,[e]:!t[e]}))},k=e=>{C(Array.isArray(e)?e:[e])},F=[{label:a("common.fields.id"),align:"right",sortable:!0,sortFn:(e,t)=>e.id-t.id},{label:a("common.fields.name"),align:"left",sortable:!0,sortFn:(e,t)=>e.name.localeCompare(t.name,"ro",{sensitivity:"base"})},{label:a("entities.employee.plural"),align:"center",sortable:!0,sortFn:(e,t)=>{var n,o;return((null===(n=e.employees)||void 0===n?void 0:n.length)||0)-((null===(o=t.employees)||void 0===o?void 0:o.length)||0)}}],R=[{render:e=>(0,o.jsxs)("span",{className:"px-4 py-2 text-sm font-mono bg-gray-50 rounded",children:["#",e.id]})},{render:e=>{var t;return(0,o.jsx)("span",{className:"truncate font-medium cursor-pointer",children:null!==(t=(0,c.wR)(e.name))&&void 0!==t?t:(0,o.jsx)("span",{className:"text-gray-400",children:"—"})})},className:"bg-zinc-50"},{render:e=>{var t;return(null===(t=e.employees)||void 0===t?void 0:t.length)?(0,o.jsxs)("button",{onClick:()=>A(e.id),className:"inline-flex items-center gap-2 px-4 py-2 bg-white hover:bg-gray-50 border border-gray-200 hover:border-gray-300 rounded-lg text-gray-700 hover:text-gray-900 transition-all duration-200 shadow-sm hover:shadow text-sm font-medium",children:[y[e.id]?(0,o.jsx)(d.Vr3,{className:"text-xs text-gray-500"}):(0,o.jsx)(d.X6T,{className:"text-xs text-gray-500"}),(0,o.jsxs)("span",{children:[e.employees.length," ",a("common.entities.employee")]})]}):(0,o.jsx)("span",{className:"text-gray-400",children:"—"})},expandedContent:{render:e=>{var t;return y[e.id]&&(null===(t=e.employees)||void 0===t?void 0:t.length)?(0,o.jsx)(m.Q,{employees:e.employees.map(t=>({...t,department:{id:e.id,name:e.name,description:e.description,createdAt:e.createdAt,updatedAt:e.updatedAt}})),tableProps:{ignoreColumns:[4,5],classNames:{container:"rounded-md overflow-x-auto shadow-xl border border-gray-200"},search:{enabled:!1}}}):null},onClose:e=>A(e.id)}}],S=l?[{icon:(0,o.jsx)(u.Yvo,{size:16}),onRowAction:e=>j(e)},{icon:(0,o.jsx)(u.b6i,{size:16}),onRowAction:e=>k(e),onBulkAction:e=>k(e)}]:[],z=(0,o.jsx)(i.W,{data:t,actions:S,headerColumns:F,dataColumns:R,padding:{dataCell:{all:4}}});return l?(0,o.jsxs)(o.Fragment,{children:[z,v&&(0,o.jsx)(r.h,{open:!0,department:v,onClose:()=>j(null),onRefresh:n}),(0,o.jsx)(p.C,{open:f.length>0,items:f,itemName:a("common.entities.department"),getIdentifier:e=>(null==e?void 0:e.id)?"#".concat(e.id):"",onConfirm:e=>{(0,h.Y)(e,w.mutate,N.mutate),C([])},onCancel:()=>C([])})]}):z},b=e=>{let{roles:t,withActions:n,refetch:l}=e,{t:r}=(0,x.Bd)(),[y,b]=(0,s.useState)({}),[v,j]=(0,s.useState)(null),[f,C]=(0,s.useState)([]),w=g.Mg.useDelete({},{onSuccess:()=>null==l?void 0:l()}),N=g.Mg.useDeleteMany({},{onSuccess:()=>null==l?void 0:l()}),A=e=>{b(t=>({...t,[e]:!t[e]}))},k=e=>{C(Array.isArray(e)?e:[e])},F=[{label:r("common.fields.id"),align:"right",sortable:!0,sortFn:(e,t)=>e.id-t.id},{label:r("common.fields.name"),align:"left",sortable:!0,sortFn:(e,t)=>e.name.localeCompare(t.name,"ro",{sensitivity:"base"})},{label:r("common.fields.description"),align:"left",sortable:!1},{label:r("entities.employee.plural"),align:"center",sortable:!0,sortFn:(e,t)=>{var n,o;return((null===(n=e.employees)||void 0===n?void 0:n.length)||0)-((null===(o=t.employees)||void 0===o?void 0:o.length)||0)}}],R=[{render:e=>(0,o.jsxs)("span",{className:"px-4 py-2 text-sm font-mono bg-gray-50 rounded",children:["#",e.id]})},{render:e=>{var t;return(0,o.jsx)("span",{className:"truncate font-medium cursor-pointer",children:null!==(t=(0,c.wR)(e.name))&&void 0!==t?t:(0,o.jsx)("span",{className:"text-gray-400",children:r("common.fields.empty")})})},className:"bg-gray-50"},{render:e=>(0,o.jsx)("span",{className:"truncate text-gray-600 text-sm",children:e.description?(0,c.wR)(e.description):(0,o.jsx)("span",{className:"text-gray-400",children:r("common.fields.empty")})})},{render:e=>{var t;return(null===(t=e.employees)||void 0===t?void 0:t.length)?(0,o.jsxs)("button",{onClick:()=>A(e.id),className:"inline-flex items-center gap-2 px-4 py-2 bg-white hover:bg-gray-50 border border-gray-200 hover:border-gray-300 rounded-lg text-gray-700 hover:text-gray-900 transition-all duration-200 shadow-sm hover:shadow text-sm font-medium",children:[y[e.id]?(0,o.jsx)(d.Vr3,{className:"text-xs text-gray-500"}):(0,o.jsx)(d.X6T,{className:"text-xs text-gray-500"}),(0,o.jsxs)("span",{children:[e.employees.length," ",r("common.entities.employee")]})]}):(0,o.jsx)("span",{className:"text-gray-400",children:r("common.fields.empty")})},expandedContent:{render:e=>{var t;return y[e.id]&&(null===(t=e.employees)||void 0===t?void 0:t.length)?(0,o.jsx)(m.Q,{employees:e.employees.map(t=>({...t,role:{id:e.id,name:e.name,description:e.description,createdAt:e.createdAt}})),tableProps:{ignoreColumns:[3],classNames:{container:"rounded-md overflow-x-auto shadow-xl border border-gray-200 w-full"},search:{enabled:!1}}}):null},onClose:e=>A(e.id)}}],S=n?[{icon:(0,o.jsx)(u.Yvo,{size:16}),onRowAction:e=>j(e)},{icon:(0,o.jsx)(u.b6i,{size:16}),onRowAction:e=>k(e),onBulkAction:e=>k(e)}]:[];return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.W,{data:t,headerColumns:F,dataColumns:R,actions:S,padding:{dataCell:{all:4}}}),v&&(0,o.jsx)(a.F,{open:!0,role:v,onClose:()=>j(null),onRefresh:l}),(0,o.jsx)(p.C,{open:f.length>0,items:f,itemName:r("common.entities.role"),getIdentifier:e=>(null==e?void 0:e.id)?"#".concat(e.id):"",onConfirm:e=>{(0,h.Y)(e,w.mutate,N.mutate),C([])},onCancel:()=>C([])})]})};var v=n(39593),j=n(75135);function f(e){let{tabs:t,defaultTab:n,children:s,...l}=e;return(0,o.jsxs)(v.A,{...l,children:[(0,o.jsx)(j.t,{tabs:t,defaultTab:n}),s]})}var C=n(59255);function w(){let{t:e}=(0,x.Bd)(),{data:t,isLoading:n,error:s,refetch:i}=g.iw.useGetAll({query:{includeDetails:!0,sort:"desc"}}),{data:c,isLoading:m,error:u,refetch:p}=g.Mg.useGetAll({query:{includeDetails:!0,sort:"desc"}}),{isOpen:h,open:v,close:j}=(0,C.u)(),{isOpen:w,open:N,close:A}=(0,C.u)();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f,{activeSection:l.w.Departments,isLoading:n||m,error:s||u,toolbar:{title:"".concat(e("entities.department.plural")," & ").concat(e("entities.role.plural")),actions:[{key:"add-department",label:e("entities.department.create"),color:"blue",icon:(0,o.jsx)(d.ymh,{size:14}),onClick:v},{key:"add-role",label:e("entities.role.create"),color:"sky",icon:(0,o.jsx)(d.vWM,{size:14}),onClick:N}]},tabs:[{key:"departments",label:e("entities.department.plural"),icon:(0,o.jsx)(d.YXz,{}),count:null==t?void 0:t.length,content:(0,o.jsx)(y,{departments:null!=t?t:[],withActions:!0,refetch:i}),noContentMessage:e("states.notFound.title",{entity:e("common.entities.department")})},{key:"roles",label:e("entities.role.plural"),icon:(0,o.jsx)(d.p7b,{}),textColor:"text-sky-600",count:null==c?void 0:c.length,content:(0,o.jsx)(b,{roles:null!=c?c:[],withActions:!0,refetch:p}),noContentMessage:e("states.notFound.title",{entity:e("common.entities.role")})}]}),(0,o.jsx)(r.h,{open:h,onClose:j,onRefresh:i}),(0,o.jsx)(a.F,{open:w,onClose:A,onRefresh:p})]})}},87598:(e,t,n)=>{Promise.resolve().then(n.bind(n,72631))}},e=>{var t=t=>e(e.s=t);e.O(0,[422,915,596,371,616,149,140,829,278,222,671,367,930,791,440,207,420,935,347,870,358],()=>t(87598)),_N_E=e.O()}]);